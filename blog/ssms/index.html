<!DOCTYPE html>
<html lang="en">

<!-- Head tag (contains Google-Analytics、Baidu-Tongji)-->
<head>
  <!-- Google Analytics -->
  

  <!-- Baidu Tongji -->
  
    <script type="text/javascript">
      // Originial
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?2bb536d3dd0b9939875b1491d84cce9c";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  <!-- Baidu Push -->
  
    <script>
      (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
      })();
    </script>
  

  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  
  
  
  <meta name="bytedance-verification-code" content="ogpqLENT9c9pWmb2XWie"/>
  
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title> SQL Server Management Studio (SSMS) 20.2 - 微软数据库管理工具 - sysin | SYStem INside | 软件与技术分享 </title>
  <meta name="description" content=" SQL Server Management Studio (SSMS) 20.2 - 微软数据库管理工具 - sysin | SYStem INside | 软件与技术分享 "/>
  <meta name="keyword" content=" SQL Server Management Studio (SSMS) 20.2 - 微软数据库管理工具 "/>
  <link rel="shortcut icon" href="/img/favicon.png"/>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>
  <link rel="manifest" href="/site.webmanifest"/>
  <!-- ga & ba script hoook -->
  <link rel="canonical" href="https://sysin.org/blog/ssms/">

  <!-- Place this tag in your head or just before your close body tag. -->
  <!-- <script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script> -->

  
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/beantech.min.css"/>

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css"/>
    <link rel="stylesheet" href="/css/widget.css"/>
    <link rel="stylesheet" href="/css/rocket.css"/>
    <link rel="stylesheet" href="/css/signature.css"/>
    <link rel="stylesheet" href="/css/catalog.css"/>
    <link rel="stylesheet" href="/css/livemylife.css"/>

    
      <!-- wave start -->
      <link rel="stylesheet" href="/css/wave.css"/>
      <!-- wave end -->
    

    
      <!-- top start (article top hot config) -->
      <link rel="stylesheet" href="/css/top.css"/>
      <!-- top end -->
    

    
      <!-- reward start -->
      <link rel="stylesheet" href="/css/donate.css"/>
      <!-- reward end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/scroll.css"/>
      <!-- ThemeColor end -->
    

    

    
      <!-- Search start -->
      <link rel="stylesheet" href="/css/search.css"/>
      <!-- Search end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/themecolor.css"/>
      <!-- ThemeColor end -->
    

    
      <!-- waline start -->
      <script type="text/javascript" src="/js/waline.js"></script>
      <!-- <script type="text/javascript" src="https://unpkg.com/@waline/client@v2/dist/waline.js"></script> -->
      <link rel="stylesheet" href="/css/waline.css"/>
      <!-- <link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"/> -->
      <!-- waline end -->
    

    

    

    
  

  <!-- Custom Fonts -->
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <!-- <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css"> -->
  <!-- GC change CDN to local: css/font-awesome.min.css & fonts/fontawesome-webfont.* 5 file-->
  <link rel="stylesheet" href="/css/font-awesome.min.css" type="text/css">
  <!-- ThemeColor Icon -->
  <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" type="text/css"/> -->
  <link rel="stylesheet" href="/css/google-icon.css" type="text/css"/>

  <!-- Hux Delete, sad but pending in China <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'> <link
  href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/ css'> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]-->


<meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="sysin" type="application/atom+xml">
<link rel="alternate" href="/feed.xml" title="sysin" type="application/rss+xml">
</head>


<!-- hack iOS CSS :active style -->

	<body ontouchstart="" class="body--light body--light">


		<!-- ThemeColor -->
		
		<!-- ThemeColor -->
<style type="text/css">
  .body--light {
    --light-mode: none;
    --dark-mode: block;
  }
  .body--dark {
    --light-mode: block;
    --dark-mode: none;
  }
  i.mdui-icon.material-icons.light-mode {
    display: var(--light-mode);
  }
  i.mdui-icon.material-icons.dark-mode {
    display: var(--dark-mode);
  }
</style>
<div class="toggle" onclick="document.body.classList.toggle('body--dark')">
  <i class="mdui-icon material-icons light-mode"></i>
  <i class="mdui-icon material-icons dark-mode"></i>
</div>
<script>
  //getCookieValue
  function getCookieValue(a) {
    var b = document.cookie.match('(^|[^;]+)\\s*' + a + '\\s*=\\s*([^;]+)');
    return b
      ? b.pop()
      : '';
  }
  let themeMode = 'light';
  if (getCookieValue('sb-color-mode') && (getCookieValue('sb-color-mode') !== themeMode)) {
    let dbody = document.body.classList;
    themeMode === 'dark' ? dbody.remove('body--dark') : dbody.add('body--dark');
  }

  //setCookieValue
  var toggleBtn = document.querySelector(".toggle");
  toggleBtn.addEventListener("click", function () {
    var e = document.body.classList.contains("body--dark");
    var cookieString = e
      ? "dark"
      : "light";
    var exp = new Date();
    exp.setTime(exp.getTime() + 3 * 24 * 60 * 60 * 1000); //3天过期
    document.cookie = "sb-color-mode=" + cookieString + ";expires=" + exp.toGMTString() + ";path=/";
  });
</script>

		

		<!-- Gitter -->
		

		<!-- Navigation (contains search)-->
		<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/" ><img src="/img/logo.png" width="64" alt="sysin" height="64" border="0" style="vertical-align:middle"></a>
      <!-- <a class="navbar-brand" href="/">sysin</a> -->
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <!-- Known Issue, found by Hux: <nav>'s height woule be hold on by its content. so, when navbar scale out, the <nav> will cover tags. also mask any touch event of tags, unfortunately. -->
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="/">首页</a>
          </li>

          
          
          <li>
            <a href="/about/">
              
              关于
              
              
            </a>
          </li>
          
          
          
          
          
          <li>
            <a href="/archive/">
              
              归档
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/categories/">
              
              分类
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/donate/">
              
              捐助
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/tags/">
              
              标签
              
              
            </a>
          </li>
          
          

          
          <li>
            <a class="popup-trigger">
              <span class="search-icon"></span>搜索</a>
          </li>
          

          <!-- LangSelect -->
          
        </ul>
      </div>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>
<!-- progress -->
<div id="progress">
  <div class="line" style="width: 0%;"></div>
</div>

<script>
  // Drop Bootstarp low-performance Navbar Use customize navbar with high-quality material design animation in high-perf jank-free CSS3 implementation
  var $body = document.body;
  var $toggle = document.querySelector('.navbar-toggle');
  var $navbar = document.querySelector('#huxblog_navbar');
  var $collapse = document.querySelector('.navbar-collapse');

  $toggle.addEventListener('click', handleMagic)

  function handleMagic(e) {
    if ($navbar.className.indexOf('in') > 0) {
      // CLOSE
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function() {
        // prevent frequently toggle
        if ($navbar.className.indexOf('in') < 0) {
          $collapse.style.height = "0px"
        }
      }, 400)
    } else {
      // OPEN
      $collapse.style.height = "auto"
      $navbar.className += " in";
    }
  }
</script>


		<!-- Post Header (contains intro-header、signature、wordcount、busuanzi、waveoverlay) -->
		<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->

  <style type="text/css">
    .body--light {
      /* intro-header */
      --intro-header-background-image-url-home: url('/img/header_img/home.jpg');
      --intro-header-background-image-url-post: url('/img/article_header/article_header.jpg');
      --intro-header-background-image-url-page: url('//img/article_header/article_header.jpg');
    }
    .body--dark {
      --intro-header-background-image-url-home: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/img/header_img/home.jpg');
      --intro-header-background-image-url-post: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/img/article_header/article_header.jpg');
      --intro-header-background-image-url-page: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('//img/article_header/article_header.jpg');
    }

    header.intro-header {
       /*post*/
        background-image: var(--intro-header-background-image-url-post);
        /* background-image: url('/img/article_header/article_header.jpg'); */
      
    }

    
  </style>





<header class="intro-header">
  <!-- Signature -->
  <div id="signature">
    <div class="container">
      <div class="row">
        <div class="col-lg-11 col-lg-offset-0 col-md-10 col-md-offset-1">
          
          <div class="post-heading">
            <div class="tags">
              
              <a class="tag" href="/tags/#Windows" title="Windows">Windows</a>
              
              <a class="tag" href="/tags/#Database" title="Database">Database</a>
              
              <a class="tag" href="/tags/#Microsoft" title="Microsoft">Microsoft</a>
              
              <a class="tag" href="/tags/#Server" title="Server">Server</a>
              
              <a class="tag" href="/tags/#SQL" title="SQL">SQL</a>
              
            </div>
            <h1>SQL Server Management Studio (SSMS) 20.2 - 微软数据库管理工具</h1>
            <h2 class="subheading"></h2>
            <span class="meta">
              Posted by sysin on
              2024-07-10
            </span>


            
            <!-- WordCount start -->
            <div class="blank_box"></div>
            <span class="meta">
              Estimated Reading Time <span class="post-count">8</span> Minutes
            </span>
            <div class="blank_box"></div>
            <span class="meta">
              Words <span class="post-count">2.1k</span> In Total
            </span>
            <div class="blank_box"></div>
            <!-- WordCount end -->
            
            


          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  <!-- waveoverlay start -->
  <div class="preview-overlay">
    <svg class="preview-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="preview-parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" fill=var(--gentle-wave1)></use>
        <use xlink:href="#gentle-wave" x="48" y="3" fill=var(--gentle-wave2)></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill=var(--gentle-wave3)></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill=var(--gentle-wave)></use>
      </g>
    </svg>
  </div>
  <!-- waveoverlay end -->
  

</header>



		<!-- Main Content (Post contains
	Pager、
	tip、
	socialshare、
	gitalk、gitment、disqus-comment、
	Catalog、
	Sidebar、
	Featured-Tags、
	Friends Blog、
	anchorjs、
	) -->
		<!-- Modify by Yu-Hsuan Yen -->
<!-- Post Content -->
<article>
  <div class="container">
    <div class="row">
      <!-- Post Container -->
      <div class="col-lg-10 col-lg-offset-0 col-md-10 col-md-offset-1 post-container">

        <!-- pageview_count start -->
        
        <div style="color:gray" align="left">
        更新日期：Wed Jul 10 2024 10:17:50 GMT+0800，阅读量: <span class="waline-pageview-count" />
        <script type="module">
          import { pageviewCount } from '/js/pageview.mjs';
          pageviewCount({
            serverURL: 'https://discuss.sysin.org',
            path: window.location.pathname,
            // 可选的，用于自定选择器，默认为 `'.waline-pageview-count'`
            // selector: 'waline-pageview-count',
            // 可选的，是否在获取时增加访问量，默认为 `true`
            // update: true,
          });
        </script>
        </div>
        
        <!-- pageview_count end -->

        <!-- toppromotion start -->
        
        <!-- toppromotion end -->

        <p>请访问原文链接：<a href="/blog/ssms/" title="SQL Server Management Studio (SSMS) 20.2 - 微软数据库管理工具">SQL Server Management Studio (SSMS) 20.2 - 微软数据库管理工具</a> 查看最新版。原创作品，转载请保留出处。</p>
<p>作者主页：<a href="https://sysin.org">sysin.org</a></p>
<hr>
<p>笔者注：SQL Server 2014 及之前版本内置 SQL Server Management Studio (SSMS)，SQL Server 2016 及以后版本需要独立安装。</p>
<p><img src="https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/Extended_Security_2120x1192_RWGaIf:VP5-1596x600?resMode=sharp2&amp;op_usm=1.5,0.65,15,0&amp;hei=600&amp;qlt=100&amp;fmt=png-alpha&amp;fit=constrain" alt="SSMS-sysin"></p>
<ul>
<li>​2024/04/09</li>
</ul>
<p>SQL Server Management Studio (SSMS) 是一种集成环境，用于管理从 SQL Server 到 Azure SQL 数据库的任何 SQL 基础结构。SSMS 提供用于配置、监视和管理 SQL Server 和数据库实例的工具 (sysin)。使用 SSMS 部署、监视和升级应用程序使用的数据层组件，以及生成查询和脚本。</p>
<p>使用 SSMS 在本地计算机或云端查询、设计和管理数据库及数据仓库，无论它们位于何处。</p>
<p>对于需要 SSMS 的跨平台助手来管理 SQL 及其他 Azure 数据库的客户，请使用 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/azure-data-studio/download-azure-data-studio">Azure Data Studio</a>。</p>
<p>有关此版本中新增功能的更多详细信息，<em>包括重要安全更改</em>，请参阅 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sql/ssms/release-notes-ssms?view=sql-server-ver16">SQL Server Management Studio (SSMS) 20.1 的发行说明</a>。</p>
<h2 id="下载-SSMS">下载 SSMS</h2>
<p><img src="https://learn.microsoft.com/zh-cn/sql/includes/media/download.svg?view=sql-server-ver16" alt="sysin"><strong><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup">下载 SQL Server Management Studio (SSMS) 20.1</a></strong></p>
<p>SSMS 20.1 是最新的正式发布 (GA) 版本。如果安装了 SSMS 20 <em>预览版</em>，请在安装 SSMS 20.1 之前将其卸载。安装 SSMS 20.1 不会升级或替换 SSMS 19.x 及更早版本。</p>
<ul>
<li>版本号：20.1</li>
<li>生成号：20.1.10.0</li>
<li>发布日期：2024 年 4 月 9 日</li>
</ul>
<p>使用 SQL Server Management Studio，即表示你同意其<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/Legal/sql/sql-server-management-studio-license-terms">许可条款</a>和<a target="_blank" rel="noopener" href="https://privacy.microsoft.com/privacystatement">隐私声明</a>。如果你有任何意见或建议，或想报告问题，最好是通过 <a target="_blank" rel="noopener" href="https://aka.ms/ssms-feedback">SQL 用户反馈</a>与 SSMS 团队联系。</p>
<p>安装 SSMS 20.x 不会升级或替换 SSMS 19.x 及更早版本。SSMS 20.x 与以前版本一起安装，因此，这两个版本均可用。但是，如果安装了 SSMS 20 的早期预览版，则必须在安装最新的 SSMS 20 之前将其卸载。转到“帮助”&gt;“关于”窗口，即可查看是否有预览版。</p>
<p>如果计算机包含 SSMS 的并行安装，请验证你是否针对特定需求启动相应的版本。最新版本标记为 <strong>Microsoft SQL Server Management Studio v20.1</strong>。</p>
<p>重要</p>
<p>对于 SQL Server Management Studio (SSMS) 18.7 到 19.3，Azure Data Studio 会自动与 SSMS 一起安装。SQL Server Management Studio 的用户可从 Azure Data Studio 的创新和功能中获益。Azure Data Studio 是适用于你的环境的跨平台开源桌面工具 (sysin)，无论是在云中、本地还是混合环境中。</p>
<p>若要了解有关 Azure Data Studio 的详细信息，请查看<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sql/azure-data-studio/what-is-azure-data-studio?view=sql-server-ver16">什么是 Azure Data Studio</a> 或<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sql/azure-data-studio/faq?view=sql-server-ver16">常见问题解答</a>。</p>
<h2 id="可用语言">可用语言</h2>
<p>此版本的 SSMS 可以安装在以下语言中：</p>
<p>SQL Server Management Studio 20.1：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup?clcid=0x804">简体中文</a></li>
<li><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup?clcid=0x404">繁体中文</a></li>
<li><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup?clcid=0x409">英语（美国）</a></li>
<li><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup?clcid=0x40c">法语</a></li>
<li><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup?clcid=0x407">德语</a></li>
<li><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup?clcid=0x410">意大利语</a></li>
<li><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup?clcid=0x411">日语</a></li>
<li><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup?clcid=0x412">朝鲜语</a></li>
<li><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup?clcid=0x416">葡萄牙语（巴西）</a></li>
<li><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup?clcid=0x419">俄语</a></li>
<li><a target="_blank" rel="noopener" href="https://aka.ms/ssmsfullsetup?clcid=0x40a">西班牙语</a></li>
</ul>
<p>如果从一个非英语的语言版本访问此页，并想要查看最新内容，请选择此页顶部的“使用英语阅读”。要下载不同的语言，请选择<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver16#available-languages">可用语言</a>。</p>
<p>备注</p>
<p>SQL Server PowerShell 模块可通过 PowerShell 库单独安装。有关详细信息，请参阅<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sql/powershell/download-sql-server-ps-module?view=sql-server-ver16">安装 SQL Server PowerShell 模块</a>。</p>
<h2 id="新增功能-27">新增功能</h2>
<p>有关此版本中新增功能的更多详细信息，请参阅 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sql/ssms/release-notes-ssms?view=sql-server-ver16">SQL Server Management Studio (SSMS) 发行说明</a>。</p>
<h2 id="以前的版本">以前的版本</h2>
<p>本文仅适用于最新版本的 SSMS。若要下载 SSMS 的早期版本，请访问 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sql/ssms/release-notes-ssms?view=sql-server-ver16#previous-ssms-releases">SSMS 的早期版本</a>。</p>
<p>备注</p>
<p>2021 年 12 月，18.6 之前的 SSMS 版本将不再通过 Microsoft Entra 多重身份验证 (MFA) 对数据库引擎进行身份验证。若要继续使用 MFA，需要 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver16">SSMS 18.6 或更高版本</a>。</p>
<p>通过 Microsoft Entra 多重身份验证连接 Azure Analysis Services 需要 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver16">SSMS 18.5.1 或更高版本</a>。</p>
<h2 id="无人参与安装">无人参与安装</h2>
<p>可以使用 PowerShell 安装 SSMS。</p>
<p>按照以下步骤在没有 GUI 提示的情况下在后台安装 SSMS。</p>
<ol>
<li>
<p>使用提升的权限启动 PowerShell。</p>
</li>
<li>
<p>键入以下命令。</p>
<p>PowerShell</p>
</li>
</ol>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$media_path</span> = <span class="string">&quot;&lt;path where SSMS-Setup-ENU.exe file is located&gt;&quot;</span></span><br><span class="line"><span class="variable">$install_path</span> = <span class="string">&quot;&lt;root location where all SSMS files will be installed&gt;&quot;</span></span><br><span class="line"><span class="variable">$params</span> = <span class="string">&quot; /Install /Quiet SSMSInstallRoot=<span class="variable">$install_path</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Start-Process</span> <span class="literal">-FilePath</span> <span class="variable">$media_path</span> <span class="literal">-ArgumentList</span> <span class="variable">$params</span> <span class="literal">-Wait</span></span><br></pre></td></tr></table></figure>
<p>例如：</p>
<p>PowerShell</p>
<ol>
<li>
<pre><code class="language-powershell">$media_path = &quot;C:\Installers\SSMS-Setup-ENU.exe&quot;
$install_path = &quot;$env:SystemDrive\SSMSto&quot;
$params = &quot;/Install /Quiet SSMSInstallRoot=`&quot;$install_path`&quot;&quot;

Start-Process -FilePath $media_path -ArgumentList $params -Wait
</code></pre>
<p>也可以传递 <code>/Passive</code> 而不是 <code>/Quiet</code> 来查看设置 UI。</p>
</li>
<li>
<p>如果一切正常，你可以看到 SSMS 安装在 %systemdrive%\SSMSto\Common7\IDE\Ssms.exe 中（示例位置）。如果出现故障，可以检查返回的错误代码，并在 <code>%TEMP%\SSMSSetup</code> 中查看日志文件。</p>
</li>
</ol>
<h2 id="卸载">卸载</h2>
<p>如果在 SSMS 安装期间确定缺少一些共享组件，SSMS 可能会安装这些组件。卸载 SSMS 时，SSMS 不会自动卸载这些组件。</p>
<p>共享组件包括：</p>
<ul>
<li>适用于 SQL Server 的 Microsoft OLE DB 驱动程序 18</li>
<li>Microsoft ODBC Driver 17 for SQL Server</li>
<li>Microsoft Visual C++ 2013 Redistributable (x86)</li>
<li>Microsoft Visual C++ 2017 Redistributable (x86)</li>
<li>Microsoft Visual C++ 2017 Redistributable (x64)</li>
<li>Microsoft Visual Studio Tools for Applications 2019</li>
</ul>
<p>由于这些组件可能与其他产品共享，因此不会卸载。如果卸载了这些组件，则可能会遇到其他产品被禁用的风险。</p>
<h2 id="使用-Azure-Data-Studio-安装">使用 Azure Data Studio 安装</h2>
<ul>
<li>对于版本 18.7 到 19.3，SSMS 默认安装 Azure Data Studio。
<ul>
<li>如果已安装相同或更高版本的 Azure Data Studio，系统会跳过通过 SSMS 安装 Azure Data Studio 的步骤。</li>
<li>可以在<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sql/ssms/release-notes-ssms?view=sql-server-ver16">发行说明</a>中找到 Azure Data Studio 版本。</li>
</ul>
</li>
<li>Azure Data Studio 系统安装程序需要与 SSMS 安装程序相同的安全权限。</li>
<li>Azure Data Studio 安装是使用默认 Azure Data Studio 安装选项完成的。它们用于创建“开始”菜单文件夹并将 Azure Data Studio 添加到路径。不会创建桌面快捷方式，也不会将 Azure Data Studio 注册为任何文件类型的默认编辑器。</li>
<li>Azure Data Studio 的本地化通过语言包扩展来实现。请从<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/azure-data-studio/extensions/add-extensions">扩展市场</a>下载相应的语言包，以将 Azure Data Studio 本地化。</li>
<li>对于版本 18.7 到 19.3，可以通过使用命令行标记 <code>DoNotInstallAzureDataStudio=1</code> 启动 SSMS 安装程序来跳过 Azure Data Studio 的安装。</li>
</ul>
<h2 id="支持的-SQL-产品-服务">支持的 SQL 产品/服务</h2>
<ul>
<li>此版本的 SSMS 适用于 SQL Server 2014 (12.x) 及更高版本。为使用 Azure SQL 数据库、Azure Synapse Analytics 和 Microsoft Fabric 中的最新云功能提供了最重要的支持。</li>
<li>此外，SSMS 20.x 可与 SSMS 19.x、SSMS 18.x、SSMS 17.x 以及 SSMS 16.x 一起安装。</li>
<li>对于 SQL Server Integration Services (SSIS)，SSMS 17.x 及更高版本不支持连接到旧版 SQL Server Integration Services 服务 (sysin)。要连接到早期版本的 Integration Services，请使用与 SQL Server 版本一致的 SSMS 版本。例如，使用 SSMS 16.x 连接到旧版 SQL Server 2016 (13.x) Integration Services 服务。可以在同一台计算机上安装 SSMS 17.x 和 SSMS 16.x。由于 SQL Server 2012 (11.x) 的发布，建议使用 SSIS 目录数据库 (SSISDB) 来存储、管理、运行和监视 Integration Services 包。有关详细信息，请参阅 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/sql/integration-services/catalog/ssis-catalog?view=sql-server-ver16">SSIS 目录</a>。</li>
</ul>
<h2 id="SSMS-系统要求">SSMS 系统要求</h2>
<p>当与最新可用的服务包一起使用时，SSMS 的当前版本支持以下 64 位平台：</p>
<p>支持的操作系统：</p>
<ul>
<li>Windows 11 (x64)</li>
<li>Windows 10 (x64) 版本 1607 (10.0.14393) 和更高版本</li>
<li>Windows Server 2022 (x64)</li>
<li>Windows Server Core 2022 (x64)</li>
<li>Windows Server 2019 (x64)</li>
<li>Windows Server Core 2019 (x64)</li>
<li>Windows Server 2016 (x64) 1</li>
</ul>
<p>1 SSMS 需要安装 .NET Framework 4.7.2。</p>
<p>备注</p>
<p>若要在 Windows Server Core 上安装 SSMS，必须安装 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/windows-server/get-started/server-core-app-compatibility-feature-on-demand">Server Core 应用兼容性按需功能</a>。</p>
<p>支持的硬件：</p>
<ul>
<li>1.8 GHz 或更快的 x86（Intel、AMD）处理器。推荐使用双核或更好的内核</li>
<li>2 GB RAM；建议 4 GB RAM（如果在虚拟机上运行，则最低 2.5 GB）</li>
<li>硬盘空间：可用空间最小为 3 GB，最大为 10 GB</li>
</ul>
<p>备注</p>
<p>对于 Windows，SSMS 只能作为 32 位应用程序使用。如果需要在 Windows 以外的操作系统上运行的工具，我们建议使用 Azure Data Studio。有关详细信息，请访问 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/azure-data-studio/what-is-azure-data-studio">Azure Data Studio</a>。</p>
<h2 id="下载地址-375">下载地址</h2>
<p>Microsoft SQL Server Management Studio (SSMS) 20.x 简体中文 | 繁體中文 | English</p>
<p>百度网盘链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/10z1rpJiZbtnG4JXBc54SYQ?pwd=bh5h">https://pan.baidu.com/s/10z1rpJiZbtnG4JXBc54SYQ?pwd=bh5h</a></p>
<p>相关产品：<a href="/blog/sql-server/" title="Microsoft SQL Server 下载汇总">Microsoft SQL Server 下载汇总</a></p>
<p>更多：<a href="/blog/windows/" title="Windows 下载汇总">Windows 下载汇总</a></p>


        <hr>
          <!-- comment_tips start -->
          
            <!-- comment_tips end -->

        <div align="center">
          <a href="/donate/">捐助本站 ❤️ Donate</a>
        </div>

        <!-- promotion start -->
        
          <div align="center">
            <p>
              <a href="https://cloud.tencent.com/act/cps/redirect?redirect=2446&cps_key=78f957e545ecb2e5e2720d6ccf030209&from=console" target="_blank"><img src="/img/banner-qcloud.webp?v20230203" style="cursor:pointer;" alt="点击访问官方网站" /></a>
            </p>
          </div>
          <hr>
          
          <!-- promotion end -->

        <!-- Pager -->
        <ul class="pager">
          
          <li class="previous">
            <a href="/blog/sql-server/" data-toggle="tooltip" data-placement="top" title="Microsoft SQL Server 下载汇总">&larr; Previous Post</a>
          </li>
          
          
          <li class="next">
            <a href="/blog/cisco-nexus-9000/" data-toggle="tooltip" data-placement="top" title="Cisco Nexus 9000 Series Switches, NX-OS Standalone 10.5(1)F and ACI Mode 16.0(7e)M">Next Post &rarr;</a>
          </li>
          
        </ul>

        
        <!-- tip start -->
        <!-- tip -->
<!-- tip start -->
<div class="tip">
  <p>
    
      文章用于推荐和分享优秀的软件产品及其相关技术，所有软件默认提供官方原版（免费版或试用版），免费分享。对于部分产品笔者加入了自己的理解和分析，方便学习和研究使用。任何内容若侵犯了您的版权，请联系作者删除。如果您喜欢这篇文章或者觉得它对您有所帮助，或者发现有不当之处，欢迎您发表评论，也欢迎您分享这个网站，或者赞赏一下作者，谢谢！
    
  </p>
</div>
<!-- tip end -->

        <!-- tip end -->
        

        
          <!-- reward Srtart -->
          <!--赞赏-->

    <div class="reward">
        <div class="reward-button">赞 <span class="reward-code">
            <span class="alipay-code"> <img class="alipay-img" src="/img/alipay-s-68.webp"><b>支付宝赞赏</b></span>
            <span class="wechat-code"> <img class="wechat-img" src="/img/wechatpay-s-68.webp"><b>微信赞赏</b> </span>
            </span></div>
        <p class="reward-notice">赞赏一下</p>
    </div>

<!--赞赏end-->
          <!-- reward End -->
        

        
        <!-- Sharing Srtart -->
        <!-- Social Social Share Post -->
<!-- sites: ['weibo', 'qq', 'wechat', 'douban', 'qzone', 'linkedin', 'facebook', 'twitter', 'google'] -->
<!-- Docs:https://github.com/overtrue/share.js -->
<div class="social-share" data-disabled="douban" data-wechat-qrcode-helper="" data-mobile-sites="weibo,wechat,qq,qzone,linkedin" align="center">
</div>

<!-- css & js -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"> -->
<!-- <script defer="defer" async="true" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script> -->
<link rel="stylesheet" href="/css/share.min.css">
<script defer="defer" async="true" src="/js/social-share.min.js"></script>

        <!-- Sharing End -->
        <hr>
        

        <!-- comments start -->
        <!-- 默认 comments: true -->
        <!-- 关闭 comments: false -->
        
        <!-- 0. waline comment (by sysin.org)-->

  <!-- waline Srtart -->
  <div style="color:gray" align="center">
    <span>☑️ 评论恢复，欢迎留言❗️</br>敬请注册！点击 “登录” - “<font color="blue">用户注册</font>”（已知不支持 21.cn/189.cn 邮箱）。<font color="red">请勿使用联合登录（已关闭）</font>。</span>
  </div>
  <div id="waline" style="all: unset; /* max-width: 100%; margin: 0 auto; */"></div>
  <style>
    :root {
      /* 字体大小 */
      --waline-font-size: 1.75rem;
      /* 头像大小 */
      --waline-avatar-size: 5.25rem;
      /* 评论状态按钮高亮色 */
      --waline-disable-bgcolor: #abe2fc;
    }
    .wl-login-nick {
      /* 昵称字体大小 */
      font-size:.05em;
    }
    /* 你需要把 `https://img.t.sinajs.cn` 换成自己的 CDN */
    .wl-content img[src^="https://unpkg.com/@waline/"] {
      width: 1.25em;
      margin: 0.25em;
      vertical-align: middle;
    }
  </style>
  <script type="text/javascript">
      Waline.init({
        el: '#waline',
        serverURL: 'https://discuss.sysin.org',
        login: 'force',
        wordLimit: [3, 300],
        pageSize: 10,
        imageUploader: false,
        search: false,
        reaction: false,
        copyright: false,
        // pageview: true,
        // path: '/blog/ssms/',
        emoji: false,
        locale: {
          admin: '作者',
          placeholder: '欢迎留言！请使用邮箱注册，注册仅需提供有效邮件地址，无需其他个人信息，谢谢。',
          level0: '777',
          level1: '755',
          level2: '644',
          level3: '600',
          level4: '400',
          level5: '000',
        },
      });
  </script>
  <!-- <div style="color:gray" align="right">
    Pageviews: <span class="waline-pageview-count" /"></span>
  </div> -->
  <!-- waline End -->
  

    <!-- 0. valine comment (by sysin.org)-->
    

        <!-- 1. gitalk comment -->
        

                  <!-- 2. gitment comment -->
                  

                      <!-- 3. disqus comment -->
                      
        <hr>
        
        <!-- comments end -->

      </div>

      <!-- Catalog: Tabe of Content -->
      <!-- Table of Contents -->

  <!-- Don not display number -->
  
    <style>
      span.toc-nav-number{
        display: none
      }
    </style>
  
  <!-- Don not display number -->
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">目录</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%B8%8B%E8%BD%BD-SSMS"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">下载 SSMS</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%8F%AF%E7%94%A8%E8%AF%AD%E8%A8%80"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">可用语言</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E6%96%B0%E5%A2%9E%E5%8A%9F%E8%83%BD-27"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">新增功能</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%BB%A5%E5%89%8D%E7%9A%84%E7%89%88%E6%9C%AC"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">以前的版本</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E6%97%A0%E4%BA%BA%E5%8F%82%E4%B8%8E%E5%AE%89%E8%A3%85"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">无人参与安装</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%8D%B8%E8%BD%BD"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">卸载</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%BD%BF%E7%94%A8-Azure-Data-Studio-%E5%AE%89%E8%A3%85"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">使用 Azure Data Studio 安装</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E6%94%AF%E6%8C%81%E7%9A%84-SQL-%E4%BA%A7%E5%93%81-%E6%9C%8D%E5%8A%A1"><span class="toc-nav-number">8.</span> <span class="toc-nav-text">支持的 SQL 产品&#x2F;服务</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#SSMS-%E7%B3%BB%E7%BB%9F%E8%A6%81%E6%B1%82"><span class="toc-nav-number">9.</span> <span class="toc-nav-text">SSMS 系统要求</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80-375"><span class="toc-nav-number">10.</span> <span class="toc-nav-text">下载地址</span></a></li></ol>
        
        </div>
      </aside>
    



      <!-- Post Domain Container -->
      <div class="col-lg-10 col-lg-offset-0 col-md-10 col-md-offset-1 sidebar-container">

        <!-- Featured Tags -->
        
        <section>
          <!-- no hr -->
          <h5>
            <a href="/tags/">特色标签</a>
          </h5>
          <div class="tags">
            
            <a class="tag" href="/tags/#Windows" title="Windows">Windows</a>
            
            <a class="tag" href="/tags/#Database" title="Database">Database</a>
            
            <a class="tag" href="/tags/#Microsoft" title="Microsoft">Microsoft</a>
            
            <a class="tag" href="/tags/#Server" title="Server">Server</a>
            
            <a class="tag" href="/tags/#SQL" title="SQL">SQL</a>
            
          </div>
        </section>
        

        <!-- Friends Blog -->
        
        <hr>
        <h5>网站链接</h5>
        <ul class="list-inline">

          
          <li>
            <a href="https://curl.qcloud.com/IQz7k8Kc" target="_blank">腾讯云限时秒杀</a>
          </li>
          
          <li>
            <a href="https://www.aliyun.com/minisite/goods?userCode=ne0pli3k" target="_blank">阿里云优惠活动</a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</article>



<!-- anchorjs start -->
<!-- async load function -->
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script type="text/javascript">
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function(e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  };
</script>
<script type="text/javascript">
  //anchor-js, Doc:http://bryanbraun.github.io/anchorjs/
  async ("/js/anchor.min.js", function() {
    anchors.options = {
      visible: 'hover',
      placement: 'left',
      // icon: 'ℬ'
      icon: '❡'
    };
    anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
  });
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

<!-- anchorjs end -->



		<!-- Footer (contains ThemeColor、viewer) -->
		<!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-11 col-lg-offset-0 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          
            <li>
              <a href="/feed.xml">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          

          

          

          

          

          

          
            <li>
              <a target="_blank" href="https://www.cnblogs.com/sysin">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse">博</i>
                </span>
              </a>
            </li>
          

          
            <li>
              <a target="_blank" href="https://www.zhihu.com/people/sysinside">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-inverse">知</i>
                </span>
              </a>
            </li>
          

          

        </ul>
        <p class="copyright text-muted">
          Copyright &copy; sysin 2024
          <br>
          Build with <a href="https://hexo.io/" target=_blank>Hexo</a>
          <span style="display: inline-block; margin: 0 5px;">
              <i class="fa fa-heart"></i>
          </span>
          Powered by <a href="https://github.com/" target=_blank><img border="0" src="/img/github.png"></a>
          <br>
          
      </p>
      </div>
    </div>
  </div>
</footer>

<a id="rocket" href="#top" class=""></a>


  <!-- jQuery -->
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <!-- Bootstrap Core JavaScript -->
  <script type="text/javascript" src="/js/bootstrap.min.js"></script>
  <!-- Custom Theme JavaScript -->
  <script type="text/javascript" src="/js/hux-blog.min.js"></script>
  <!-- catalog -->
  <script async="true" type="text/javascript" src="/js/catalog.js"></script>
  <!-- totop(rocket) -->
  <script async="true" type="text/javascript" src="/js/totop.js"></script>

  

  
    <!-- Scroll start -->
    <script async="async" type="text/javascript" src="/js/scroll.js"></script>
    <!-- Scroll end -->
  

  

  

  
    <!-- ribbon -->
    <script type="text/javascript" src="/js/ribbonDynamic.js"></script>
  

  







<script>
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function (e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  }

  // fastClick.js
  //GC change fastclick.min.js to local and rename to fc.min.js, because AdBlock Plus
  //https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js
  //https://cdn.staticfile.org/fastclick/1.0.6/fastclick.min.js
  async ("/js/fc.min.js", function () {
    var $nav = document.querySelector("nav");
    if ($nav)
      FastClick.attach($nav);
    }
  )
</script>

<!-- Because of the native support for backtick-style fenced code blocks right within the Markdown is landed in Github Pages, From V1.6, There is no need for Highlight.js, so Huxblog drops it officially. -
https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0 - https://help.github.com/articles/creating-and-highlighting-code-blocks/ -->
<!-- <script> async ("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function () { hljs.initHighlightingOnLoad(); }) </script> <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet"> -->

<!-- jquery.tagcloud.js -->
<!-- <script> // only load tagcloud.js in tag.html if ($('#tag_cloud').length !== 0) { async ("https://sysin.org/js/jquery.tagcloud.js", function () { $.fn.tagcloud.defaults = { // size: { start: 1, end: 1, unit: 'em' }, color: {
start: '#bbbbee', end: '#0085a1' } }; $('#tag_cloud a').tagcloud(); }) } </script> -->


		<!-- Search -->
		
		<div class="popup search-popup local-search-popup">
  <span class="popup-btn-close">
    ESC
  </span>
  <div class="container">
    <div class="row">
      <div class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1 local-search-content">

        <div class="local-search-header clearfix">

          <div class="local-search-input-wrapper">
            <span class="search-icon">
              <i class="fa fa-search fa-lg" style="margin: 25px 10px 25px 20px;"></i>
            </span>
            <input autocomplete="off" placeholder="搜索..." type="text" id="local-search-input">
          </div>
        </div>
        <div id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>


  
    <script src="/js/ziploader.js"></script>
  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').fadeOut(300);
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $('.popup').fadeIn(300);
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // get search zip version
    $.get('/searchVersion.json?t=' + (+new Date()), function (res) {
      if (localStorage.getItem('searchVersion') !== res) {
        localStorage.setItem('searchVersion', res);
        initSearchJson();
      }
    });

    function initSearchJson() {
      initLoad(['/search.fle'], {
        loadOptions: {
          success: function (obj) {
            localStorage.setItem('searchJson', obj['search.json'])
          },
          error: function (e) {
            return console.log(e)
          }
        },
        returnOptions: {
          'json': TYPE_TEXT
        },
        mimeOptions: {
          'json': 'application/json'
        }
      })
    }
    // search function;
    var searchFunc = function (search_id, content_id) {
      'use strict';
      isfetched = true;
      var datas = JSON.parse(localStorage.getItem('searchJson'));
      // console.log(search_id)
      var input = document.getElementById(search_id);
      var resultContent = document.getElementById(content_id);
      var inputEventFunction = function () {
        var searchText = input.value.trim().toLowerCase();
        var keywords = searchText.split(/[\s\-]+/);
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        var resultItems = [];
        if (searchText.length > 0) {
          // perform local searching
          datas.forEach(function (data) {
            var isMatch = false;
            var hitCount = 0;
            var searchTextCount = 0;
            var title = data.title
              ? data.title.trim()
              : '';
            var titleInLowerCase = title.toLowerCase();
            var content = data.content
              ? data.content.trim().replace(/<[^>]+>/g, "")
              : '';
            var contentInLowerCase = content.toLowerCase();
            var articleUrl = decodeURIComponent(data.url);

            var date = data.date;
            var dateTime = date.replace(/T/, " ").replace(/.000Z/, "");
            var imgUrl = data.header_img;
            


            var indexOfTitle = [];
            var indexOfContent = [];
            // only match articles with not empty titles
            keywords.forEach(function (keyword) {
              function getIndexByWord(word, text, caseSensitive) {
                var wordLen = word.length;
                if (wordLen === 0) {
                  return [];
                }
                var startPosition = 0,
                  position = [],
                  index = [];
                if (!caseSensitive) {
                  text = text.toLowerCase();
                  word = word.toLowerCase();
                }
                while ((position = text.indexOf(word, startPosition)) > -1) {
                  index.push({position: position, word: word});
                  startPosition = position + wordLen;
                }
                return index;
              }
              indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
              indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
            });
            if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
              isMatch = true;
              hitCount = indexOfTitle.length + indexOfContent.length;
            }
            // show search results
            if (isMatch) {
              // sort index by position of keyword
              [indexOfTitle, indexOfContent].forEach(function (index) {
                index.sort(function (itemLeft, itemRight) {
                  if (itemRight.position !== itemLeft.position) {
                    return itemRight.position - itemLeft.position;
                  } else {
                    return itemLeft.word.length - itemRight.word.length;
                  }
                });
              });
              // merge hits into slices
              function mergeIntoSlice(text, start, end, index) {
                var item = index[index.length - 1];
                var position = item.position;
                var word = item.word;
                var hits = [];
                var searchTextCountInSlice = 0;
                while (position + word.length <= end && index.length != 0) {
                  if (word === searchText) {
                    searchTextCountInSlice++;
                  }
                  hits.push({position: position, length: word.length});
                  var wordEnd = position + word.length;
                  // move to next position of hit
                  index.pop();
                  while (index.length != 0) {
                    item = index[index.length - 1];
                    position = item.position;
                    word = item.word;
                    if (wordEnd > position) {
                      index.pop();
                    } else {
                      break;
                    }
                  }
                }
                searchTextCount += searchTextCountInSlice;
                return {hits: hits, start: start, end: end, searchTextCount: searchTextCountInSlice};
              }
              var slicesOfTitle = [];
              if (indexOfTitle.length != 0) {
                slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
              }
              var slicesOfContent = [];
              while (indexOfContent.length != 0) {
                var item = indexOfContent[indexOfContent.length - 1];
                var position = item.position;
                var word = item.word;
                // cut out 100 characters
                var start = position - 20;
                var end = position + 80;
                if (start < 0) {
                  start = 0;
                }
                if (end < position + word.length) {
                  end = position + word.length;
                }
                if (end > content.length) {
                  end = content.length;
                }
                slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
              }
              // sort slices in content by search text's count and hits' count
              slicesOfContent.sort(function (sliceLeft, sliceRight) {
                if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                  return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                  return sliceRight.hits.length - sliceLeft.hits.length;
                } else {
                  return sliceLeft.start - sliceRight.start;
                }
              });
              // select top N slices in content
              var upperBound = parseInt('1');
              if (upperBound >= 0) {
                slicesOfContent = slicesOfContent.slice(0, upperBound);
              }
              // highlight title and content
              function highlightKeyword(text, slice) {
                var result = '';
                var prevEnd = slice.start;
                slice.hits.forEach(function (hit) {
                  result += text.substring(prevEnd, hit.position);
                  var end = hit.position + hit.length;
                  result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                  prevEnd = end;
                });
                result += text.substring(prevEnd, slice.end);
                return result;
              }
              var resultItem = '';

              // if (slicesOfTitle.length != 0) {   resultItem += "<li><a target='_blank' href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>"; } else {   resultItem += "<li><a target='_blank' href='" +
              // articleUrl + "' class='search-result-title'>" + title + "</a>"; } slicesOfContent.forEach(function (slice) {   resultItem += "<a target='_blank' href='" + articleUrl + "'><p class=\"search-result\">" + highlightKeyword(content, slice) +
              // "...</p></a>"; }); resultItem += "</li>";

              if (slicesOfTitle.length != 0) {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</div><time class='search-result-date'>" + dateTime + "</time>";
              } else {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + title + "</div><time class='search-result-date'>" + dateTime + "</time>";
              }
              slicesOfContent.forEach(function (slice) {
                resultItem += "<p class=\"search-result-content\">" + highlightKeyword(content, slice) + "...</p>";
              });
              resultItem += "</div><div class='search-result-right'><img class='media-image' src='" + imgUrl + "' width='64px' height='48px'></img></div></a>";

              resultItems.push({item: resultItem, searchTextCount: searchTextCount, hitCount: hitCount, id: resultItems.length});
            }
          })
        };

        if (keywords.length === 1 && keywords[0] === "") {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else if (resultItems.length === 0) {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else {
          resultItems.sort(function (resultLeft, resultRight) {
            if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
              return resultRight.searchTextCount - resultLeft.searchTextCount;
            } else if (resultLeft.hitCount !== resultRight.hitCount) {
              return resultRight.hitCount - resultLeft.hitCount;
            } else {
              return resultRight.id - resultLeft.id;
            }
          });
          var searchResultList = '<div class=\"search-result-list\">';
          resultItems.forEach(function (result) {
            searchResultList += result.item;
          })
          searchResultList += "</div>";
          resultContent.innerHTML = searchResultList;
        }
      }
      if ('auto' === 'auto') {
        input.addEventListener('input', inputEventFunction);
      } else {
        $('.search-icon').click(inputEventFunction);
        input.addEventListener('keypress', function (event) {
          if (event.keyCode === 13) {
            inputEventFunction();
          }
        });
      }
      // remove loading animation
      $('body').css('overflow', '');
      proceedsearch();
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function (e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc('local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function (e) {
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 && $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    document.addEventListener('mouseup', (e) => {
      var _con = document.querySelector(".local-search-content");
      if (_con) {
        if (!_con.contains(e.target)) {
          onPopupClose();
        }
      }
    });
  </script>


		
	<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
