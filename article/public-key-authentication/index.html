<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="数据中心：系统、平台和应用交付">
    <meta name="keyword"  content="Apple,macOS,iOS,Cisco,IOS,IOS-XE,NX-OS,Nexus,ACI,Docker,Kubernetes,F5,BIG-IP,LTM,DNS,ASM,Linux,CentOS,Ubuntu,Microsoft,Windows,Oracle,Palo Alto,PAN-OS,VMware,ESXi,vCenter,NSX,VSAN,FortiGate,FortiOS,Firepower">
    <link rel="shortcut icon" href="/img/favicon.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          使用 Public Key 认证 - System Inside | 数据中心：系统、平台和应用交付
        
    </title>

    <link rel="canonical" href="http://sysin.org/article/public-key-authentication/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/beantech.min.css">

    <link rel="stylesheet" href="/css/donate.css">

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
<link rel="alternate" href="/atom.xml" title="System Inside" type="application/atom+xml">
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('/img/article_header/article_header.jpg')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 col-lg-offset-1 col-md-11 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#Linux" title="Linux">Linux</a>
                            
                              <a class="tag" href="/tags/#PAN-OS" title="PAN-OS">PAN-OS</a>
                            
                              <a class="tag" href="/tags/#FortiOS" title="FortiOS">FortiOS</a>
                            
                              <a class="tag" href="/tags/#F5" title="F5">F5</a>
                            
                              <a class="tag" href="/tags/#CISCO" title="CISCO">CISCO</a>
                            
                              <a class="tag" href="/tags/#NX-OS" title="NX-OS">NX-OS</a>
                            
                        </div>
                        <h1>使用 Public Key 认证</h1>
                        <h2 class="subheading">本文介绍了 Public Key 认证的一般原理，及其在 Linux、CISCO IOS、CISCO NX-OS、F5 BIG-IP、Palo Alto PAN-OS、Fortinet FortiOS 和 Juniper JUNOS 中的配置方法及建议。</h2>
                        <span class="meta">
                            Posted by sysin on
                            2020-08-21
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll" >
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/" ><img src="/img/logo.png" width="64" height="64" border="0" style="vertical-align:middle"/></a>
        </div>
        <!-- <a class="navbar-brand" href="/">System Inside</a> -->
        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    

                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="col-lg-10 col-lg-offset-1 col-md-11 col-md-offset-1 post-container">

                <p>作者：gc(at)sysin.org，主页：<a href="https%EF%BC%9A//www.sysin.org">www.sysin.org</a></p>
<p>原文发布链接：<a href="https://www.sysin.org/article/public-key-authentication/" target="_blank" rel="noopener">https://www.sysin.org/article/public-key-authentication/</a></p>
<p>摘要：本文介绍了 Public Key 认证的一般原理，及其在 Linux、CISCO IOS、CISCO NX-OS、F5 BIG-IP、Palo Alto PAN-OS、Fortinet FortiOS 和 Juniper JUNOS 中的配置方法及建议。</p>
<hr>
<h2 id="一-public-key-认证基本原理">一、Public Key 认证基本原理</h2>
<p>Public Key（非对称，asymmetric）认证使用一对相关联的 Key Pair（一个公钥 Public Key，一个私钥 Private Key）来代替传统的密码（或我们常说的口令，Password）。顾名思义，Public Key 是用来公开的，可以将其放到 SSH 服务器自己的帐号中，而 Private Key 只能由自己保管，用来证明自己身份。</p>
<p>使用 Public Key 加密过的数据只有用与之相对应的 Private Key 才能解密。这样在认证的过程中，Public Key 拥有者便可以通过Public Key 加密一些东西发送给对应的 Private Key 拥有者，如果在通信的双方都拥有对方的 Public Key（自己的 Private Key 只由自己保管），那么就可以通过这对 Key Pair 来安全地交换信息，从而实现相互认证。在使用中，我们把自己的 Public Key 放在通过安全渠道放到服务器上，Private Key 自己保管（用一个口令把 Private Key 加密后存放），而服务器的 Public Ke y一般会在第一次登录服务器的时候存放到本地客户端（严格地说来服务器的 Public Key 也应该通过安全渠道放到本地客户端，以防止别人用他自己的 Public Key 来欺骗登录）。</p>
<h2 id="二-public-key-认证相对于-password-认证的优点">二、Public Key 认证相对于 Password 认证的优点</h2>
<p>常用的 SSH 认证方式有：</p>
<pre><code>a. 基于主机 IP（rhost）的认证：对于某个主机（IP）信任并让之登录，这种认证容易受到 IP 欺骗攻击。
b. Kerberos 认证：一个大型的基于域的认证，这种认证安全性高，但是太大、太复杂不方便部署。
c. PAM 认证：类似于传统的密码认证，是绝大多数 Unix/Linux 系统自带的一个认证和记帐的模块，它的功能比较复杂，配置起来比较麻烦。而且，容易由于配置失误而引起安全问题。
d. 传统的 Unix/Linux 口令（或密码 Password）认证：在客户端直接输入帐号密码，然后让 SSH 加密传输到服务器端验证。
</code></pre>
<p>在众多 SSH 登录认证中，传统的单口令（Password）认证用得比较多，所以在这里我们主要对比一下 SSH 认证中的口令（Password）认证和 Public Key 认证的区别。这种认证方式有着如下明显的缺点：</p>
<pre><code>1）为了确保密码安全，密码必须很长很复杂，但是这样的密码很难记忆；
2）对于自己所拥有的每个帐号，为了安全，不同的帐号都要设置不同的密码，管理起来很不方便；
3）对于默认帐号，默认密码，例如装机时用的帐号，如果一时疏忽没有改密码，被其它不怀好意的人扫描到帐号和密码，可能会造成安全漏洞；
4）如果远程主机已经被攻击，即使使用 SSH 安全通道进行保护，在网络上发送的密码在到达远程主机时也可能被截获；
5）对于每个帐号的修改都要人工登录（为了安全，不能把 Password 放到脚本里），随着服务器数量增多，这项工作会变得十分烦琐。
</code></pre>
<p>相反，使用 Public Key 认证正好可以解决上述问题，即其优势所在。</p>
<h2 id="三-linux-public-key-配置">三、Linux Public Key 配置</h2>
<p>使用一种被称为&quot;公私钥&quot;认证的方式来进行 ssh 登录. &quot;公私钥&quot;认证方式简单的解释：首先在客户端上创建一对公私钥 （公钥文件：~/.ssh/id_rsa.pub； 私钥文件：~/.ssh/id_rsa）</p>
<p>然后把公钥放到服务器上（~/.ssh/authorized_keys）, 自己保留好私钥。在使用 ssh 登录时，ssh 程序会发送私钥去和服务器上的公钥做匹配。如果匹配成功就可以登录了。</p>
<p>步骤如下：先要在本地生成一个 rsa 的公共 key，然后 copy 到远程你要认证的服务器创建 key</p>
<p>（1）本地</p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">SYSIN-SRV#</span><span class="bash"> ssh-keygen -t rsa  <span class="comment">#可选参数 -b 2048，CentOS7 中默认</span></span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa)：</span><br><span class="line">Created directory '/root/.ssh'.</span><br><span class="line">Enter passphrase (empty for no passphrase)：</span><br><span class="line">Enter same passphrase again：</span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is：</span><br><span class="line">SHA256：MfZHl/b8XhGTU59fhLHptmzNFnhCrorySvGojyb69dM root@SYSIN-SRV  #root@SYSIN-SRV 这里是当前用户名@主机名，公钥文件中可以删除</span><br><span class="line">The key's randomart image is：</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|+= = . . ....    |</span><br><span class="line">|O.E +   o    .   |</span><br><span class="line">|*+     o    . .  |</span><br><span class="line">|+o. . . o. . .   |</span><br><span class="line">|+  o o .SBo .    |</span><br><span class="line">|  . + oo++=+     |</span><br><span class="line">|   o +. o.+.     |</span><br><span class="line">|  . o..  o  .    |</span><br><span class="line">|   . ...  ..     |</span><br><span class="line">+----[SHA256]-----+</span><br></pre></td></tr></table></figure></p>
<p>直接三次回车即可，这里会提示输入密码 passphrase，这个密码与与远程 ssh 登入密码无关，Public-key 证机制比密码要安全，因为密码不在网络上传输。而且可以是用加密的方式存储的，为了安全，也可以设置一个 passphrase，这样，别人拿到密钥也没有用。</p>
<p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># cd .ssh/</span></span><br><span class="line"><span class="meta"># ls</span></span><br><span class="line">id_rsa  id_rsa.pub  known_hosts</span><br><span class="line"><span class="meta"># cp id_ras.pub authorized_keys <span class="comment">//本机公钥配置，允许 ssh localhost 免密登录</span></span></span><br><span class="line"><span class="comment">//id_rsa 文件复制到其他机器上复用，权限需要设置为700</span></span><br><span class="line"><span class="meta"># chmod 700 id_rsa</span></span><br></pre></td></tr></table></figure></p>
<p>（2）将公钥文件复制到远程服务器上：</p>
<p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># ssh-copy-id root@目标节点IP</span></span><br></pre></td></tr></table></figure></p>
<p>这里 root 是在目标节点上登录的用户，@ 符号后面接目标节点 IP 即可，之后会提示输入目标节点 root 用户密码，输入即可。</p>
<p>添加认证信息后，目标节点主机的 ~/.ssh/ 目录下将会出现一个 authorized_keys 文件，里面包含了管理节点的公钥信息，可以检查一下是否存在。</p>
<p>保存好上述生成的公钥和私钥文件后，可以上传到其他主机（或者网络设备）上直接使用：</p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 直接上传已有的 Public key</span></span></span><br><span class="line">mkdir .ssh</span><br><span class="line">cd .ssh</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 上传 id_rsa  id_rsa.pub 到当前目录</span></span></span><br><span class="line">cp id_rsa.pub authorized_keys</span><br><span class="line">chmod 700 id_rsa</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 测试访问是否正常</span></span></span><br><span class="line">ssh localhost</span><br></pre></td></tr></table></figure></p>
<p>（3）修改 sshd 配置文件：</p>
<p>启用 Public key 认证并关闭传统密码认证，重启 sshd 服务生效。</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/ssh/sshd_config</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line">PasswordAuthentication no</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># CentOS 7 默认配置如下</span></span></span><br><span class="line">PasswordAuthentication yes</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 取消注释#PubkeyAuthentication yes</span></span></span><br><span class="line">sed -i 's/^#\(PubkeyAuthentication yes\)/\1/' /etc/ssh/sshd_config</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 修改为PasswordAuthentication no，即替换行</span></span></span><br><span class="line">sed -i '/^PasswordAuthentication yes/c PasswordAuthentication no' /etc/ssh/sshd_config</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 写入文件需要添加 -i 参数</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 重启sshd服务</span></span></span><br><span class="line">service sshd restart</span><br></pre></td></tr></table></figure></p>
<h2 id="四-ssh-客户端设置">四、SSH 客户端设置</h2>
<h3 id="1-使用-putty-客户端">1. 使用 Putty 客户端</h3>
<p>如果使用 Windows 中的 Putty</p>
<p>如果想使用 putty，因为 ssh-keygen 生成的 SSH2 和 putty 的 key 格式不同，无法直接使用，必须用 puttygen.exe 转换一下：</p>
<p>把 Linux 的 id_rsa copy 到 windows 中，运行 puttygen.exe，选择菜单 Conversions -&gt; Import key 然后 save private key，就可以使用这个 private key 设置 putty 了。</p>
<p>Windows 中设置 Putty 使用 key</p>
<p>1） 启动 Putty，设置好 session 的各项参数（如果以前已经设置过，那么 load 一下），然后从左边选择“SSH-&gt;Auth”，点击 Browse 按钮，选择 key.ppk 文件。
2） 设置 auto-login 用户名，Connection -&gt; Data -&gt; Auto-login username
3） 再从左边选择 Session，然后点击 Save 按钮把修改保存下来。然后点击 Open 按钮就可以登录了。</p>
<p>如果上面的操作都没有问题，那这时应该就自动登录了，无需输入密码。</p>
<p>putty 的密钥转换成 SecureCRT 的密钥</p>
<p>以前用的是 putty，生成了 PUB/PRIVATE KEY的，现在用 puttygen.exe load private key，然后用 Conversions 导出到 openssh 格式的 private key，名为 identy，接着把 pubkey 也导出来，叫 identy.pub，放到相同的目录下，最后在 securecrt 的 session 里指定 private key 就 OK 了，一定要弄成 xx xx.pub 的形式，否则会说找不到密码。</p>
<h3 id="2-使用-securecrt-配置公钥">2. 使用 SecureCRT 配置公钥</h3>
<p>在 Windows 客户机上，建立 C:/SSH 目录，然后将 id_dsa 和 id_dsa.pub 原封不动的复制到 C:/SSH 里，确保文件名为 id_dsa 和 id_dsa.pub（macOS类似）</p>
<pre><code>第一步，按向导正常连接一台主机 SSH，填写主机名和用户名
第二步，编辑会话主机的属性，Connection--SSH2，右侧 Authentication 页面选中 PublicKey，点击 “Properties...”
第三步，默认选中 Use global public key ，Use identity or certificate file 那里，点击“...”按钮，浏览我的电脑，找到 C:/SSH 目录，选中 id_dsa 文件，然后确定。
</code></pre>
<p>保存好配置，关闭 SecureCRT，然后打开配置了证书的主机，正常情况下将提示要输入密钥的加密字，输入后就应该可以登录进系统了。
同时再打开另一个 SecureCRT 窗口。登录同样的主机，由于 SecureCRT 已缓存了证书及加密字，因此不再需要输入用户名密码，使用就很方便了！</p>
<h2 id="五-cisco-ios">五、Cisco IOS</h2>
<h3 id="1-启用-public-key-认证">1. 启用 public key 认证</h3>
<h4 id="在-linux-上生成-key">在 Linux 上生成 key</h4>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">SYSIN-SRV#</span><span class="bash"> ssh-keygen -t rsa  <span class="comment">#可选参数 -b 2048，CentOS7 中默认</span></span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa)：</span><br><span class="line">Created directory '/root/.ssh'.</span><br><span class="line">Enter passphrase (empty for no passphrase)：</span><br><span class="line">Enter same passphrase again：</span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is：</span><br><span class="line">SHA256：MfZHl/b8XhGTU59fhLHptmzNFnhCrorySvGojyb69dM root@SYSIN-SRV  #root@SYSIN-SRV 这里是当前用户名@主机名，公钥文件中可以删除</span><br><span class="line">The key's randomart image is：</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|+= = . . ....    |</span><br><span class="line">|O.E +   o    .   |</span><br><span class="line">|*+     o    . .  |</span><br><span class="line">|+o. . . o. . .   |</span><br><span class="line">|+  o o .SBo .    |</span><br><span class="line">|  . + oo++=+     |</span><br><span class="line">|   o +. o.+.     |</span><br><span class="line">|  . o..  o  .    |</span><br><span class="line">|   . ...  ..     |</span><br><span class="line">+----[SHA256]-----+</span><br></pre></td></tr></table></figure></p>
<h4 id="在-linux-主机上查看-public-key">在 Linux 主机上查看 public key</h4>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat ~/.ssh/id_rsa.pub</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 默认是一行</span></span></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDefQcDto4gCHqf0umUCAY1O7GHPwU+Se92aUHVkVI4Kd8sJVFoQKjvMga9dRm12zGDDO/wM9tSHWKc+msARsz2m6h1HbsiR7CoOTPtTuDc/BN3m7Q7SGXzf51AI3tvOQ4IhlDwRMFBLGTFVVDjpYMDZjwZNEwCBbeZMETNUedCvbyduEmOaZIm5LzCQ5upPG+uEMsP5Sh8XQX5vK8P5P04EmCAEqned5FmHMrPI3kGfabxRhiLa7Ujv3gMh4z59tKmVsoMyKXU3gf+561D9BdvuTo+gvtUElghBvz3wiPA45KW7LL2INBXiJ89p0iOmkiAEnxkDdsXpq+GEj2PaiE9</span><br></pre></td></tr></table></figure></p>
<h4 id="转换成多行格式">转换成多行格式</h4>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Cisco does not accept the entire key pasted into one long line, so you need to break it into multiple lines. The maximum line length at the Cisco CLI is 254 characters, but it's convenient to wrap smaller than this so that it fits on a terminal line.</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> fold -b -w 72 ~/.ssh/id_rsa.pub</span></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDefQcDto4gCHqf0umUCAY1O7GHPwU+Se92</span><br><span class="line">aUHVkVI4Kd8sJVFoQKjvMga9dRm12zGDDO/wM9tSHWKc+msARsz2m6h1HbsiR7CoOTPtTuDc</span><br><span class="line">/BN3m7Q7SGXzf51AI3tvOQ4IhlDwRMFBLGTFVVDjpYMDZjwZNEwCBbeZMETNUedCvbyduEmO</span><br><span class="line">aZIm5LzCQ5upPG+uEMsP5Sh8XQX5vK8P5P04EmCAEqned5FmHMrPI3kGfabxRhiLa7Ujv3gM</span><br><span class="line">h4z59tKmVsoMyKXU3gf+561D9BdvuTo+gvtUElghBvz3wiPA45KW7LL2INBXiJ89p0iOmkiA</span><br><span class="line">EnxkDdsXpq+GEj2PaiE9</span><br></pre></td></tr></table></figure></p>
<h4 id="在-cisco-ios-上配置">在 Cisco IOS 上配置</h4>
<p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">conf t</span><br><span class="line">username admin privilege <span class="number">15</span> <span class="comment">//创建一个没有密码的账号admin</span></span><br><span class="line">ip ssh pubkey-chain</span><br><span class="line">username admin</span><br><span class="line">key-<span class="built_in">string</span></span><br><span class="line">&lt;&lt; paste your multi-line <span class="keyword">public</span> key here &gt;&gt;</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure></p>
<h4 id="验证">验证</h4>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show run | beg pubkey</span><br></pre></td></tr></table></figure></p>
<h3 id="2-其他配置">2. 其他配置</h3>
<h4 id="security-settings">Security settings</h4>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## 禁用SSH v1</span><br><span class="line">ip ssh version 2</span><br><span class="line">## 禁用telnet</span><br><span class="line">line vty 0 15</span><br><span class="line"> transport input ssh</span><br></pre></td></tr></table></figure></p>
<h4 id="multiple-keys">Multiple keys</h4>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">## It is possible to have multiple public keys against the same user in the configuration, so that multiple people can login using the same account. Just add further keys as shown above. When you show the configuration, it will look like this：</span><br><span class="line"></span><br><span class="line">ip ssh pubkey-chain</span><br><span class="line">  username nsrc</span><br><span class="line">   key-hash ssh-rsa EFF40492D1D6BF5D0B68491128456D27 yourname@yourdomain.example</span><br><span class="line">   key-hash ssh-rsa 768CD77578B0C1B55BCC0C3549D3E573 another@yourdomain.example</span><br></pre></td></tr></table></figure></p>
<h4 id="移除密码">移除密码</h4>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## You can remove passwords from users in the configuration; this will force those users to use ssh key authentication. If these people require admin rights they will either still need to know the enable secret, or their login can drop them directly into enable mode：</span><br><span class="line">username foo privilege 15</span><br><span class="line">示例：</span><br><span class="line">no username admin</span><br><span class="line">username admin privilege 15</span><br></pre></td></tr></table></figure></p>
<h4 id="disable-passwords-entirely">Disable passwords entirely</h4>
<p><strong>全局设定，无法通过密码远程访问!!!</strong></p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">## If you wish to disable password authentication entirely over ssh, but leave passwords on user accounts for other purposes (e.g. console access), then use：</span><br><span class="line">## 禁用SSH的密码认证，但是保留用户密码用于console登录</span><br><span class="line">no ip ssh server authenticate user password</span><br><span class="line">no ip ssh server authenticate user keyboard</span><br></pre></td></tr></table></figure></p>
<p>安全建议：
有公网 IP 访问建议启用，特别是设定的用户名比较敏感比如 root、admin 等，取消密码，直接使用 public key 认证</p>
<h2 id="六-cisco-nx-os">六、CISCO NX-OS</h2>
<h3 id="1-生成公钥文件id_rsapub参看linux">1. 生成公钥文件id_rsa.pub（参看Linux）</h3>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">SYSIN-SRV#</span><span class="bash"> ssh-keygen -t rsa  <span class="comment">#可选参数 -b 2048，CentOS7 中默认</span></span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa)：</span><br><span class="line">Created directory '/root/.ssh'.</span><br><span class="line">Enter passphrase (empty for no passphrase)：</span><br><span class="line">Enter same passphrase again：</span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is：</span><br><span class="line">SHA256：MfZHl/b8XhGTU59fhLHptmzNFnhCrorySvGojyb69dM root@SYSIN-SRV  #root@SYSIN-SRV 这里是当前用户名@主机名，公钥文件中可以删除</span><br><span class="line">The key's randomart image is：</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|+= = . . ....    |</span><br><span class="line">|O.E +   o    .   |</span><br><span class="line">|*+     o    . .  |</span><br><span class="line">|+o. . . o. . .   |</span><br><span class="line">|+  o o .SBo .    |</span><br><span class="line">|  . + oo++=+     |</span><br><span class="line">|   o +. o.+.     |</span><br><span class="line">|  . o..  o  .    |</span><br><span class="line">|   . ...  ..     |</span><br><span class="line">+----[SHA256]-----+</span><br></pre></td></tr></table></figure></p>
<h3 id="2-配置用户使用密钥">2. 配置用户使用密钥</h3>
<h4 id="21-传输-id_rsapub-文件到交换机的-bootflash-中并配置用户">2.1. 传输 id_rsa.pub 文件到交换机的 bootflash 中并配置用户</h4>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">N9K#copy sftp：  bootflash</span><br></pre></td></tr></table></figure></p>
<p>示例使用的用户名为 sysadmin</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">N9K##conf</span><br><span class="line">N9K(config)#username sysadmin role network-admin  //创建一个没有密码的用户</span><br><span class="line">N9K(config)#username sysadmin sshkey file bootflash：id_rsa.pub</span><br></pre></td></tr></table></figure></p>
<h4 id="22-直接复制密钥进行配置">2.2. 直接复制密钥进行配置</h4>
<p>第二种方式：直接复制 id_rsa.pub 中的 key 输入如下：</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">N9K##conf</span><br><span class="line">N9K(config)#username sysadmin role network-admin  //创建一个没有密码的用户</span><br><span class="line">N9K(config)#username sysadmin sshkey ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDefQcDto4gCHqf0umUCAY1O7GHPwU+Se92aUHVkVI4Kd8sJVFoQKjvMga9dRm12zGDDO/wM9tSHWKc+msARsz2m6h1HbsiR7CoOTPtTuDc/BN3m7Q7SGXzf51AI3tvOQ4IhlDwRMFBLGTFVVDjpYMDZjwZNEwCBbeZMETNUedCvbyduEmOaZIm5LzCQ5upPG+uEMsP5Sh8XQX5vK8P5P04EmCAEqned5FmHMrPI3kGfabxRhiLa7Ujv3gMh4z59tKmVsoMyKXU3gf+561D9BdvuTo+gvtUElghBvz3wiPA45KW7LL2INBXiJ89p0iOmkiAEnxkDdsXpq+GEj2PaiE9</span><br></pre></td></tr></table></figure></p>
<h3 id="3-验证配置">3. 验证配置</h3>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">N9K# show user-account sysadmin</span><br><span class="line">user：sysadmin</span><br><span class="line">        this user account has no expiry date</span><br><span class="line">        roles：network-admin</span><br><span class="line">no password set. Local login not allowed  //没有设置密码只能远程登录</span><br><span class="line">Remote login through RADIUS/TACACS+ is possible</span><br><span class="line">        ssh public key： ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDefQcDto4gCHqf0umUCAY1O7GHPw</span><br><span class="line">        U+Se92aUHVkVI4Kd8sJVFoQKjvMga9dRm12zGDDO/wM9tSHWKc+msARsz2m6h1HbsiR7CoOTPtTuDc/BN3</span><br><span class="line">        m7Q7SGXzf51AI3tvOQ4IhlDwRMFBLGTFVVDjpYMDZjwZNEwCBbeZMETNUedCvbyduEmOaZIm5LzCQ5upPG+uEMsP5Sh8XQX5vK8P5P04EmCAEqned5FmHMrPI3kGfabxRhiLa7Ujv3gMh4z59tKmVsoMyKXU3gf+561D</span><br><span class="line">        9BdvuTo+gvtUElghBvz3wiPA45KW7LL2INBXiJ89p0iOmkiAEnxkDdsXpq+GEj2PaiE9</span><br></pre></td></tr></table></figure></p>
<h3 id="4-验证">4. 验证</h3>
<p>使用 Linux 主机 SSH 登录到交换机上并执行命令，没有任何密码提示：</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SYSIN-SRV# ssh sysadmin@10.66.78.53 &quot;sh system uptime&quot;</span><br><span class="line">Warning： the output may not have all the roles</span><br><span class="line">System start time： Tue May 29 17：51：30 2012</span><br><span class="line">System uptime： 7 days, 19 hours, 42 minutes, 15 seconds</span><br><span class="line">Kernel uptime： 7 days, 19 hours, 45 minutes, 17 seconds</span><br></pre></td></tr></table></figure></p>
<h2 id="七-f5-big-ip">七、F5 BIG-IP</h2>
<h3 id="1-标准做法">1. 标准做法</h3>
<p>使用 publc key 认证，参看官方文档：<a href="https%EF%BC%9A//support.f5.com/csp/article/K13454">K13454</a></p>
<p>F5 基于 CentOS 构建，与 Linux 操作方式类似。</p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 直接上传已有的Public key</span></span></span><br><span class="line">cd /root</span><br><span class="line">mkdir .ssh</span><br><span class="line">cd .ssh</span><br><span class="line">上传 id_rsa.pub 到 .ssh 目录下</span><br><span class="line">cp id_rsa.pub authorized_keys</span><br></pre></td></tr></table></figure></p>
<p>如果是要两台之间免密登录</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">上传 id_rsa 到 .ssh 目录下</span><br><span class="line">chmod 700 id_rsa</span><br><span class="line">## 测试访问是否正常</span><br><span class="line">ssh localhost</span><br></pre></td></tr></table></figure></p>
<p>默认 PubkeyAuthentication 是开启的，不需要像 Linux 那样修改 sshd 配置文件（/config/ssh/sshd_config）。</p>
<p>注意：</p>
<ol>
<li>禁用密码登录，似乎不支持</li>
<li>限制源地址访问sshd：全局限制，不能针对用户个别设置</li>
</ol>
<p>安全建议：</p>
<ol>
<li>建议设定 sshd 和 httpd 限制源地址访问</li>
<li>禁用默认 admin 和 root 账号</li>
<li>创建替代的管理员帐号</li>
</ol>
<h3 id="2-建议做法">2. 建议做法：</h3>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -m 755 -p /var/ssh/&lt;username&gt;</span><br><span class="line">mv /home/&lt;username&gt;/.ssh/authorized_keys /var/ssh/&lt;username&gt;</span><br><span class="line"><span class="built_in">cd</span> /home/&lt;username&gt;/.ssh &amp;&amp; ln -s /var/ssh/&lt;username&gt;/authorized_keys</span><br></pre></td></tr></table></figure></p>
<p>参看系统默认 root 账号配置</p>
<p>当前支持版本：v11.6.5，v12.1.5，v13.1.0，v14.1.0，v15.1.0，v16.0.0 及以上</p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost：Active：Standalone] config # cd /root/.ssh</span><br><span class="line">[root@localhost：Active：Standalone] config # alias ll='ls -lahF --color'</span><br><span class="line">[root@localhost：Active：Standalone] .ssh # ll</span><br><span class="line">total 10K</span><br><span class="line">drwxr-xr-x. 2 root root 1.0K Jun 23 20：13 ./</span><br><span class="line">dr-x------. 3 root root 1.0K Jul 14 21：42 ../</span><br><span class="line">lrwxrwxrwx. 1 root root   29 Jun 23 20：13 authorized_keys -&gt; /var/ssh/root/authorized_keys</span><br><span class="line">lrwxrwxrwx. 1 root root   22 Jun 23 20：13 identity -&gt; /var/ssh/root/identity</span><br><span class="line">lrwxrwxrwx. 1 root root   26 Jun 23 20：13 identity.pub -&gt; /var/ssh/root/identity.pub</span><br><span class="line">lrwxrwxrwx. 1 root root   25 Jun 23 20：13 known_hosts -&gt; /var/ssh/root/known_hosts</span><br><span class="line">-rw-r--r--. 1 root root  262 Jun 23 16：27 README</span><br><span class="line">[root@localhost：Active：Standalone] .ssh # cat README</span><br><span class="line">WARNING!!</span><br><span class="line"></span><br><span class="line">Do not manually change the files in this directory!</span><br><span class="line">The ssh keys in this directory are generated at first boot and are unique</span><br><span class="line">to your machine.</span><br><span class="line">These keys are needed for communication with the SCCP.</span><br><span class="line"></span><br><span class="line">To generate new keys, please run `keyswap.sh sccp`.</span><br></pre></td></tr></table></figure></p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost：Active：Standalone] config # find / -name authorized_keys</span><br><span class="line">/shared/ssh/root/authorized_keys</span><br><span class="line">/root/.ssh/authorized_keys</span><br><span class="line">find： &apos;/proc/13236&apos;： No such file or directory</span><br><span class="line">find： &apos;/proc/13267&apos;： No such file or directory</span><br><span class="line">find： &apos;/opt/.sdm/proc/13324&apos;： No such file or directory</span><br><span class="line"></span><br><span class="line">[root@localhost：Active：Standalone] config # ll /shared/ssh/root/authorized_keys</span><br><span class="line">-rw-r--r--. 1 root root 406 Jul 14 20：06 /shared/ssh/root/authorized_keys</span><br><span class="line">[root@localhost：Active：Standalone] config # cat /shared/ssh/root/authorized_keys</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCKV2v1jzTATRIbyat3g6WruNQSWDcdKNafhG66rNyAJ09guCukkjbRwARJGzZWKxdhSqqHvMW32fZYAX6ZCl/9eDoGjh08eKELJVxn6q7UI3xAM/ze+4GUrSStlEdagBsB/sNGvp0gr1b0eaALFpE2VsLxVr1wVpcPMKbPr7HHPfQsALakI3El5zayi6U7Ei1W7dU3hs8WoIlj89eMiuFCUXyZDtBaXht0C2nWk8C6SPJjpVfPNh++dttzW2GOfSLvwEKoCHmYGKe/aolYYvdRVGXSOpqDzZsNWBHHSyU92RqMCm1VLM1mg/ew4KFzYocdlpDssh2IaZTbua7Af+P7 Host Processor Superuser</span><br><span class="line"></span><br><span class="line">[root@localhost：Active：Standalone] config # ll /root/.ssh/authorized_keys</span><br><span class="line">lrwxrwxrwx. 1 root root 29 Jun 23 20：13 /root/.ssh/authorized_keys -&gt; /var/ssh/root/authorized_keys</span><br><span class="line">[root@localhost：Active：Standalone] config # cat /root/.ssh/authorized_keys</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCKV2v1jzTATRIbyat3g6WruNQSWDcdKNafhG66rNyAJ09guCukkjbRwARJGzZWKxdhSqqHvMW32fZYAX6ZCl/9eDoGjh08eKELJVxn6q7UI3xAM/ze+4GUrSStlEdagBsB/sNGvp0gr1b0eaALFpE2VsLxVr1wVpcPMKbPr7HHPfQsALakI3El5zayi6U7Ei1W7dU3hs8WoIlj89eMiuFCUXyZDtBaXht0C2nWk8C6SPJjpVfPNh++dttzW2GOfSLvwEKoCHmYGKe/aolYYvdRVGXSOpqDzZsNWBHHSyU92RqMCm1VLM1mg/ew4KFzYocdlpDssh2IaZTbua7Af+P7 Host Processor Superuser</span><br></pre></td></tr></table></figure></p>
<h2 id="八-palo-alto-pan-os">八、Palo Alto PAN-OS</h2>
<h3 id="1-生成-ssh-key参照-linux">1. 生成 ssh key，参照 Linux</h3>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">SYSIN-SRV#</span><span class="bash"> ssh-keygen -t rsa  <span class="comment">#可选参数 -b 2048，CentOS7 中默认</span></span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa)：</span><br><span class="line">Created directory '/root/.ssh'.</span><br><span class="line">Enter passphrase (empty for no passphrase)：</span><br><span class="line">Enter same passphrase again：</span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is：</span><br><span class="line">SHA256：MfZHl/b8XhGTU59fhLHptmzNFnhCrorySvGojyb69dM root@SYSIN-SRV  #root@SYSIN-SRV 这里是当前用户名@主机名，公钥文件中可以删除</span><br><span class="line">The key's randomart image is：</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|+= = . . ....    |</span><br><span class="line">|O.E +   o    .   |</span><br><span class="line">|*+     o    . .  |</span><br><span class="line">|+o. . . o. . .   |</span><br><span class="line">|+  o o .SBo .    |</span><br><span class="line">|  . + oo++=+     |</span><br><span class="line">|   o +. o.+.     |</span><br><span class="line">|  . o..  o  .    |</span><br><span class="line">|   . ...  ..     |</span><br><span class="line">+----[SHA256]-----+</span><br></pre></td></tr></table></figure></p>
<h3 id="2-配置-public-key-认证">2. 配置 Public Key 认证</h3>
<h4 id="21-使用-gui-界面">2.1 使用 GUI 界面</h4>
<p>参看<a href="https://www.paloaltonetworks.com/documentation/71/pan-os/pan-os/firewall-administration/configure-ssh-key-based-administrator-authentication-to-the-cli" target="_blank" rel="noopener">官方文档</a></p>
<p>创建或者编辑一个帐号</p>
<p>Device -- Administrators，点击 Add</p>
<p>勾选 Use Public Key Authentication (SSH)，点击 Import Key，浏览到 id_rsa.pub</p>
<p>可以看到导入后的 key 内容有所变化，被<a href="https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClJLCA0" target="_blank" rel="noopener">自动转换为Base64编码格式</a>，在使用命令行输入时也需要 Base64 编码格式，否则会报错。</p>
<p>勾选 Use only client certificate authentication (Web)，则不需要为账号创建密码（编辑原有用户勾选此选项，原用户密码继续有效）。</p>
<p>此时该用户无法使用 SSH 密码登录，因为没有密码，Web 界面也将无法登录。</p>
<h4 id="22-使用-cli">2.2 使用 CLI</h4>
<p>创建一个同时使用密码和 key 认证的用户账号 sa1</p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set mgt-config users sa1 password</span><br><span class="line">Enter password   ：</span><br><span class="line">Confirm password ：</span><br><span class="line">set mgt-config users sa1 permissions role-based superuser yes</span><br><span class="line">set mgt-config users sa1 public-key c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDbjRLMy9Ld1VNZkdJVm4xbDYxNTZOTDR2WHl0T3FORHJUZ2FWb05lcEZuL2tuaE9FOGR4YW1pWWNNK0xJMVU5aksvOVdjeTd0Q2tCeUR3YWs5RjBnS1NVUUlURWpJZTkzNytNQ1NxQU4xR1MxTlNsa2IvcmZjUEs1dGIyam9TejFyb3cyTXl6WDZLVGZDVkc0eVN6UWFTeDRnZmg0d0ZJb3poejdyVFB3YlQ0cjRtejVCaEdKRklBRzAyeUNMdVZNbkhVN0VPdVFmaDI5WTN1cjhOcWdJdnY2UXRTUHN0a0N5dzdrOXNaWmMyZitVVmtTK0FOZVN0dnpXR2JuZ0V0OFlaQjRlRTN1RzRwVWJxbEFXenJjbXVXVmZZRXR6Wkh6VVVtSFlPb1poRVdXbzQ4OER1VXF1NUEvZVJkK1RaZE42WUdMZkliT3dxcG9GVFJyNXc0VEggcm9vdEBTU0xYMTIxCg==</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 注意 public-key 使用Base64编码格式，可以通过Web界面转换</span></span></span><br></pre></td></tr></table></figure></p>
<p>创建一个仅仅使用 key 认证的用户账号 sa2（该用户无法登录 GUI）</p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set mgt-config users sa2 permissions role-based superuser yes</span><br><span class="line">set mgt-config users sa2 client-certificate-only yes</span><br><span class="line">set mgt-config users sa2 public-key c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDbjRLMy9Ld1VNZkdJVm4xbDYxNTZOTDR2WHl0T3FORHJUZ2FWb05lcEZuL2tuaE9FOGR4YW1pWWNNK0xJMVU5aksvOVdjeTd0Q2tCeUR3YWs5RjBnS1NVUUlURWpJZTkzNytNQ1NxQU4xR1MxTlNsa2IvcmZjUEs1dGIyam9TejFyb3cyTXl6WDZLVGZDVkc0eVN6UWFTeDRnZmg0d0ZJb3poejdyVFB3YlQ0cjRtejVCaEdKRklBRzAyeUNMdVZNbkhVN0VPdVFmaDI5WTN1cjhOcWdJdnY2UXRTUHN0a0N5dzdrOXNaWmMyZitVVmtTK0FOZVN0dnpXR2JuZ0V0OFlaQjRlRTN1RzRwVWJxbEFXenJjbXVXVmZZRXR6Wkh6VVVtSFlPb1poRVdXbzQ4OER1VXF1NUEvZVJkK1RaZE42WUdMZkliT3dxcG9GVFJyNXc0VEggcm9vdEBTU0xYMTIxCg==</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 注意 public-key 使用Base64编码格式，可以通过Web界面转换</span></span></span><br></pre></td></tr></table></figure></p>
<h2 id="九-fortinet-fortios">九、Fortinet FortiOS</h2>
<blockquote>
<p>以下在 FortiOS 6.0 下测试通过</p>
</blockquote>
<ul>
<li>生成密钥</li>
</ul>
<p>一般使用 RSA 2048-bit key，参考 Linux 生成方式</p>
<ul>
<li>语法</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  config system admin</span><br><span class="line">    edit admin</span><br><span class="line">      set ssh-public-key1 &quot;&lt;key-type&gt; &lt;key-value&gt;&quot;</span><br><span class="line">    next</span><br><span class="line">end</span><br></pre></td></tr></table></figure></p>
<ul>
<li>示例</li>
</ul>
<blockquote>
<p>注意格式：不要用开头和结尾的 ---- BEGIN SSH2 PUBLIC KEY ---- 或者注释&quot;[2048-bit dsa,...]&quot; 或者 ---- END SSH2 PUBLIC KEY ---- 等内容
示例，同时删除已经设置的密码，新账号不用设置密码：</p>
</blockquote>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  config system admin</span><br><span class="line">    edit sadmin</span><br><span class="line">      set ssh-public-key1 &quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDefQcDto4gCHqf0umUCAY1O7GHPwU+Se92aUHVkVI4Kd8sJVFoQKjvMga9dRm12zGDDO/wM9tSHWKc+msARsz2m6h1HbsiR7CoOTPtTuDc/BN3m7Q7SGXzf51AI3tvOQ4IhlDwRMFBLGTFVVDjpYMDZjwZNEwCBbeZMETNUedCvbyduEmOaZIm5LzCQ5upPG+uEMsP5Sh8XQX5vK8P5P04EmCAEqned5FmHMrPI3kGfabxRhiLa7Ujv3gMh4z59tKmVsoMyKXU3gf+561D9BdvuTo+gvtUElghBvz3wiPA45KW7LL2INBXiJ89p0iOmkiAEnxkDdsXpq+GEj2PaiE9&quot;</span><br><span class="line">      unset password &quot;要删除的账号的密码&quot;</span><br><span class="line">    next</span><br><span class="line">end</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>经过测试这里 <code>unset password</code> 后，密码为空，即无需密码就能登录，这或许与一般安全产品的理念不同（没有钥匙则无法开锁）。</p>
</blockquote>
<ul>
<li>注意点：需要同时设置密码！</li>
</ul>
<h2 id="十-juniper-junos">十、Juniper JUNOS</h2>
<h3 id="1-官方文档">1. 官方文档</h3>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Enable SSH service on the switch using the following command：</span></span></span><br><span class="line"><span class="meta">root@Juniper#</span><span class="bash"> <span class="built_in">set</span> system services ssh</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Generate the SSH key on a device running Junos OS  by logging into the shell prompt as a root user：</span></span></span><br><span class="line"><span class="meta">root@Juniper&gt;</span><span class="bash">start shell</span></span><br><span class="line"><span class="meta">root@Juniper%</span><span class="bash"> ssh-keygen -t rsa</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Once the keys are generated we can associate the key with the "userid" using the following command.</span></span></span><br><span class="line"><span class="meta">root@Juniper#</span><span class="bash"><span class="built_in">set</span> system login user &lt;userid&gt; uid 2000</span></span><br><span class="line"><span class="meta">root@Juniper#</span><span class="bash"><span class="built_in">set</span> system login user &lt;userid&gt; class super-user</span></span><br><span class="line"><span class="meta">root@Juniper#</span><span class="bash"><span class="built_in">set</span> system login user &lt;userid&gt; authentication load-key-file /root/.ssh/id_rsa.pub</span></span><br><span class="line"></span><br><span class="line">After running the above configuration commands, it will create a directory with &lt;userid&gt; in /var/home and the authorized_key for SSH will be created.</span><br><span class="line"></span><br><span class="line">When an upgrade/downgrade is performed, the files id_rsa and id_rsa.pub, which are locally created and are not part of configuration, will not be restored. Hence we will have to copy the contents of the /root/.ssh directory and put them back after the upgrade/downgrade is complete. We also will have to associate the user with the key using the following CLI command：</span><br><span class="line"></span><br><span class="line"><span class="meta">root@Juniper#</span><span class="bash"><span class="built_in">set</span> system login user &lt;userid&gt; authentication load-key-file /root/.ssh/id_rsa.pub</span></span><br></pre></td></tr></table></figure></p>
<h3 id="2-快速配置">2. 快速配置</h3>
<p>通常我们已经用 Linux 生成了自己的公钥和私钥，这里直接使用。</p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 使用root账号登录，将公钥文件id_rsa.pub上传到/root/.ssh/下面（默认需要创建.ssh文件夹）</span></span></span><br><span class="line">start shell</span><br><span class="line">cd /root</span><br><span class="line">mkdir .ssh</span><br><span class="line">cd .ssh</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Cluster环境，将id_rsa.pub上传到另外一个节点node1</span></span></span><br><span class="line">rcp -T /root/.ssh/id_rsa.pub node1：/root/.ssh/</span><br><span class="line">rlogin -T node1</span><br><span class="line">ls /root/.ssh/id_rsa.pub</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 新建账号，若账号已经创建并使用密码认证，将同时使用pub认证</span></span></span><br><span class="line">set system login user &lt;username&gt; class super-user authentication load-key-file /root/.ssh/id_rsa.pub</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 示例 使用key认证并取消密码认证</span></span></span><br><span class="line">set system login user sysadmin class super-user authentication load-key-file /root/.ssh/id_rsa.pub</span><br><span class="line">delete system login user sysadmin authentication encrypted-password #删除已有账号密码认证</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 示例 同时使用密码和key认证</span></span></span><br><span class="line">set system login user sysadmin class super-user authentication plain-text-password</span><br><span class="line">set system login user sysadmin class super-user authentication load-key-file /root/.ssh/id_rsa.pub</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 删除用户命令为：delete system login user &lt;username&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 禁用root账号ssh登录</span></span></span><br><span class="line">set system services ssh root-login deny</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 恢复</span></span></span><br><span class="line">set system services ssh root-login allow</span><br></pre></td></tr></table></figure></p>
<h3 id="3-建议做法">3. 建议做法</h3>
<p>1). root 账号有密码，使用 root 账号上传 /root/.ssh/id_rsa.pub
2). 新建一个 admin1 账号，注意不要使用敏感字符，使用 public key 认证，无密码
3). 新建一个 admin2 账号，注意不要使用敏感字符，有复杂密码，或者同时使用 public key 认证，必要时候应急使用
4). 禁用 root ssh login
5). 必要时限制源地址访问，禁用密码认证</p>



                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                    
                        <li class="next">
                            <a href="/article/Download-VMware-Horizon-8.0-2006/" data-toggle="tooltip" data-placement="top" title="VMware Horizon 8.0 2006 下载">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <br>

                <!--打赏-->
                
                <!--打赏-->

                <br>
                <!--分享-->
                
                    <div class="social-share"  data-wechat-qrcode-helper="" align="center"></div>
                    <!--  css & js -->
                    <link rel="stylesheet" href="/css/share.min.css">
                    <script src="/js/social-share.min.js"></script>
                
                <!--分享-->
                <br>

                <!-- require APlayer -->
                

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->

                

            </div>

            <!-- Tabe of Content -->
            <!-- Table of Contents -->

<!-- !page.toc_nav_num = dispaly number change by gc -->
  
    <style>
      span.toc-nav-number{
        display: none
      }
    </style>
  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#一-public-key-认证基本原理"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">&#x4E00;&#x3001;Public Key &#x8BA4;&#x8BC1;&#x57FA;&#x672C;&#x539F;&#x7406;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#二-public-key-认证相对于-password-认证的优点"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">&#x4E8C;&#x3001;Public Key &#x8BA4;&#x8BC1;&#x76F8;&#x5BF9;&#x4E8E; Password &#x8BA4;&#x8BC1;&#x7684;&#x4F18;&#x70B9;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#三-linux-public-key-配置"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">&#x4E09;&#x3001;Linux Public Key &#x914D;&#x7F6E;</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#四-ssh-客户端设置"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">&#x56DB;&#x3001;SSH &#x5BA2;&#x6237;&#x7AEF;&#x8BBE;&#x7F6E;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-使用-putty-客户端"><span class="toc-nav-number">4.1.</span> <span class="toc-nav-text">1. &#x4F7F;&#x7528; Putty &#x5BA2;&#x6237;&#x7AEF;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-使用-securecrt-配置公钥"><span class="toc-nav-number">4.2.</span> <span class="toc-nav-text">2. &#x4F7F;&#x7528; SecureCRT &#x914D;&#x7F6E;&#x516C;&#x94A5;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#五-cisco-ios"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">&#x4E94;&#x3001;Cisco IOS</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-启用-public-key-认证"><span class="toc-nav-number">5.1.</span> <span class="toc-nav-text">1. &#x542F;&#x7528; public key &#x8BA4;&#x8BC1;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#在-linux-上生成-key"><span class="toc-nav-number">5.1.1.</span> <span class="toc-nav-text">&#x5728; Linux &#x4E0A;&#x751F;&#x6210; key</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#在-linux-主机上查看-public-key"><span class="toc-nav-number">5.1.2.</span> <span class="toc-nav-text">&#x5728; Linux &#x4E3B;&#x673A;&#x4E0A;&#x67E5;&#x770B; public key</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#转换成多行格式"><span class="toc-nav-number">5.1.3.</span> <span class="toc-nav-text">&#x8F6C;&#x6362;&#x6210;&#x591A;&#x884C;&#x683C;&#x5F0F;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#在-cisco-ios-上配置"><span class="toc-nav-number">5.1.4.</span> <span class="toc-nav-text">&#x5728; Cisco IOS &#x4E0A;&#x914D;&#x7F6E;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#验证"><span class="toc-nav-number">5.1.5.</span> <span class="toc-nav-text">&#x9A8C;&#x8BC1;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-其他配置"><span class="toc-nav-number">5.2.</span> <span class="toc-nav-text">2. &#x5176;&#x4ED6;&#x914D;&#x7F6E;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#security-settings"><span class="toc-nav-number">5.2.1.</span> <span class="toc-nav-text">Security settings</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#multiple-keys"><span class="toc-nav-number">5.2.2.</span> <span class="toc-nav-text">Multiple keys</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#移除密码"><span class="toc-nav-number">5.2.3.</span> <span class="toc-nav-text">&#x79FB;&#x9664;&#x5BC6;&#x7801;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#disable-passwords-entirely"><span class="toc-nav-number">5.2.4.</span> <span class="toc-nav-text">Disable passwords entirely</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#六-cisco-nx-os"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">&#x516D;&#x3001;CISCO NX-OS</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-生成公钥文件id_rsapub参看linux"><span class="toc-nav-number">6.1.</span> <span class="toc-nav-text">1. &#x751F;&#x6210;&#x516C;&#x94A5;&#x6587;&#x4EF6;id_rsa.pub&#xFF08;&#x53C2;&#x770B;Linux&#xFF09;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-配置用户使用密钥"><span class="toc-nav-number">6.2.</span> <span class="toc-nav-text">2. &#x914D;&#x7F6E;&#x7528;&#x6237;&#x4F7F;&#x7528;&#x5BC6;&#x94A5;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#21-传输-id_rsapub-文件到交换机的-bootflash-中并配置用户"><span class="toc-nav-number">6.2.1.</span> <span class="toc-nav-text">2.1. &#x4F20;&#x8F93; id_rsa.pub &#x6587;&#x4EF6;&#x5230;&#x4EA4;&#x6362;&#x673A;&#x7684; bootflash &#x4E2D;&#x5E76;&#x914D;&#x7F6E;&#x7528;&#x6237;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#22-直接复制密钥进行配置"><span class="toc-nav-number">6.2.2.</span> <span class="toc-nav-text">2.2. &#x76F4;&#x63A5;&#x590D;&#x5236;&#x5BC6;&#x94A5;&#x8FDB;&#x884C;&#x914D;&#x7F6E;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-验证配置"><span class="toc-nav-number">6.3.</span> <span class="toc-nav-text">3. &#x9A8C;&#x8BC1;&#x914D;&#x7F6E;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#4-验证"><span class="toc-nav-number">6.4.</span> <span class="toc-nav-text">4. &#x9A8C;&#x8BC1;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#七-f5-big-ip"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">&#x4E03;&#x3001;F5 BIG-IP</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-标准做法"><span class="toc-nav-number">7.1.</span> <span class="toc-nav-text">1. &#x6807;&#x51C6;&#x505A;&#x6CD5;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-建议做法"><span class="toc-nav-number">7.2.</span> <span class="toc-nav-text">2. &#x5EFA;&#x8BAE;&#x505A;&#x6CD5;&#xFF1A;</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#八-palo-alto-pan-os"><span class="toc-nav-number">8.</span> <span class="toc-nav-text">&#x516B;&#x3001;Palo Alto PAN-OS</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-生成-ssh-key参照-linux"><span class="toc-nav-number">8.1.</span> <span class="toc-nav-text">1. &#x751F;&#x6210; ssh key&#xFF0C;&#x53C2;&#x7167; Linux</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-配置-public-key-认证"><span class="toc-nav-number">8.2.</span> <span class="toc-nav-text">2. &#x914D;&#x7F6E; Public Key &#x8BA4;&#x8BC1;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#21-使用-gui-界面"><span class="toc-nav-number">8.2.1.</span> <span class="toc-nav-text">2.1 &#x4F7F;&#x7528; GUI &#x754C;&#x9762;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#22-使用-cli"><span class="toc-nav-number">8.2.2.</span> <span class="toc-nav-text">2.2 &#x4F7F;&#x7528; CLI</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#九-fortinet-fortios"><span class="toc-nav-number">9.</span> <span class="toc-nav-text">&#x4E5D;&#x3001;Fortinet FortiOS</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#十-juniper-junos"><span class="toc-nav-number">10.</span> <span class="toc-nav-text">&#x5341;&#x3001;Juniper JUNOS</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#1-官方文档"><span class="toc-nav-number">10.1.</span> <span class="toc-nav-text">1. &#x5B98;&#x65B9;&#x6587;&#x6863;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#2-快速配置"><span class="toc-nav-number">10.2.</span> <span class="toc-nav-text">2. &#x5FEB;&#x901F;&#x914D;&#x7F6E;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#3-建议做法"><span class="toc-nav-number">10.3.</span> <span class="toc-nav-text">3. &#x5EFA;&#x8BAE;&#x505A;&#x6CD5;</span></a></li></ol></li></ol>
        
        </div>
      </aside>
    


            <!-- Sidebar Container -->
            <div class="col-lg-10 col-lg-offset-1 col-md-11 col-md-offset-1 post-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#Linux" title="Linux">Linux</a>
                        
                          <a class="tag" href="/tags/#PAN-OS" title="PAN-OS">PAN-OS</a>
                        
                          <a class="tag" href="/tags/#FortiOS" title="FortiOS">FortiOS</a>
                        
                          <a class="tag" href="/tags/#F5" title="F5">F5</a>
                        
                          <a class="tag" href="/tags/#CISCO" title="CISCO">CISCO</a>
                        
                          <a class="tag" href="/tags/#NX-OS" title="NX-OS">NX-OS</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>SITE LINKS</h5>
                <ul class="list-inline">

                    
                        <li><a href="http://blog.csdn.net/netgc" target="_blank">CSDN Blog</a></li>
                    
                        <li><a href="https://blog.51cto.com/250823" target="_blank">51CTO Blog</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>








<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>


<!-- chrome Firefox 中文锚点定位失效-->
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
<!-- smooth scroll behavior polyfill  -->
<script type="text/javascript" src="/js/smoothscroll.js"></script>
<script>
        $('#toc').on('click','a',function(a){
            // var isChrome = window.navigator.userAgent.indexOf("Chrome") !== -1;
            // console.log(window.navigator.userAgent,isChrome)
                // if(isChrome) {
                    // console.log(a.currentTarget.outerHTML);
                    // console.log($(a.currentTarget).attr("href"));
                    //跳转到指定锚点
                    // document.getElementById(a.target.innerText.toLowerCase()).scrollIntoView(true);
                    document.getElementById($(a.currentTarget).attr("href").replace("#","")).scrollIntoView({behavior: 'smooth' });
                // }
        })
</script>


    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-10 col-lg-offset-1 col-md-11 col-md-offset-1">
                <ul class="list-inline text-center">
                
                    <li>
                        <a target="_blank" href="/atom.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/netgc">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                

                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/netgc">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; sysin 2020
                    <br>
                    Build with <a href="https://hexo.io/" target=_blank>Hexo</a>
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span>
                    Powered by <a href="https://github.com/" target=_blank><img border="0" src="https://github.githubassets.com/favicons/favicon.svg" /></a>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://sysin.org/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = '2bb536d3dd0b9939875b1491d84cce9c';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>




	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="http://sysin.org/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
